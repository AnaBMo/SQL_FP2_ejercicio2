DROP DATABASE IF EXISTS CONCESIONARIO;

CREATE DATABASE IF NOT EXISTS CONCESIONARIO;
USE CONCESIONARIO;


CREATE TABLE CLIENTE (
	DNI CHAR(9) PRIMARY KEY,
    NOMBRE VARCHAR(20),
	APELLIDOS VARCHAR(80),
    FEC_NAC DATE,
    FEC_CARNET DATE,
    BONIFICACION FLOAT
);

CREATE TABLE CONCESIONARIO(
	CODIGO CHAR(6) PRIMARY KEY,
    NOMBRE VARCHAR(40),
    DIRECCION VARCHAR(80),
    CIUDAD VARCHAR(40),
    PROVINCIA VARCHAR(40)
);

CREATE TABLE VEHICULO (
    MATRICULA VARCHAR(10) PRIMARY KEY,
    MARCA VARCHAR(40),
    MODELO VARCHAR(40),
    ANIO_FAB YEAR,
    KILOMETROS FLOAT,
    OBSERVACIONES TEXT,
    CLASE CHAR(1),
    CONCESIONARIO CHAR(6),
	CONSTRAINT VEH_FK FOREIGN KEY (CONCESIONARIO) REFERENCES CONCESIONARIO(CODIGO) ON DELETE CASCADE ON UPDATE CASCADE
);

CREATE TABLE ALQUILAR(
	MATRICULA VARCHAR(10),
    DNI CHAR(9),
    FEC_ALQUILER DATE,
    FEC_ENTREGA DATE,
    KMS_RECORRE FLOAT,
    INCIDENTES TEXT,
    IMPORTE DECIMAL(6,2),
    PRIMARY KEY(MATRICULA,DNI,FEC_ALQUILER),
    CONSTRAINT MAT_VEH_FK FOREIGN KEY (MATRICULA) REFERENCES VEHICULO(MATRICULA) ON DELETE CASCADE ON UPDATE CASCADE, 
    CONSTRAINT DNI_CLI_FK FOREIGN KEY (DNI) REFERENCES CLIENTE(DNI) ON DELETE CASCADE ON UPDATE CASCADE       
);

/*Insertamos la información en la tabla CLIENTE*/
INSERT INTO CLIENTE VALUES('11111111A','Juan','Gonzalez Fernandez','1986-03-24','2023-09-29', 15 );
INSERT INTO CLIENTE VALUES('22222222B','Ramon','Rodriguez Fernandez','1999-09-02','2018-05-01', 10 );
INSERT INTO CLIENTE VALUES('33333333C','María','Martin Saez','2000-11-24','2023-01-11', 0 );
INSERT INTO CLIENTE VALUES('44444444D','Laura','Gutierrez Añon','2001-06-04','2024-05-20', 0 );
INSERT INTO CLIENTE VALUES('55555555E','Inma','Dominguez Cerrato','1993-03-03','2014-12-24',5);
INSERT INTO CLIENTE VALUES('44155222X','Jose','Torres Lopez','1980-03-24','2008-07-07', 15 );
INSERT INTO CLIENTE VALUES('74747474G','Luis','Miguel Casado','1998-08-01','2018-05-14', 20 );
INSERT INTO CLIENTE VALUES('85858585H','Francisco','Heiver Jhons','1994-05-25','2013-09-27', 25 );
INSERT INTO CLIENTE VALUES('96969696I','Salvador','Rubiales Perez','1992-08-02','2011-04-01', 0 );
INSERT INTO CLIENTE VALUES('25252525J','Ascension','Rodriguez Ruiz','1992-06-24','2011-02-22', 15 );

/*Insertamos la información en la tabla CONCESIONARIO*/
INSERT INTO CONCESIONARIO VALUES('000001','CONCESUR','POLIGONO EL PINO','SEVILLA','SEVILLA');
INSERT INTO CONCESIONARIO VALUES('000002','CONCESTE','POLIGONO CABEZA HERMOSA','SEVILLA ESTE','SEVILLA');
INSERT INTO CONCESIONARIO VALUES('000003','CONCEOESTE','POLIGONO JUNCAL','MAZAGON','HUELVA');
INSERT INTO CONCESIONARIO VALUES('000004','CONCENORTE','POLIGONO CALONGE','CABRA','CORDOBA');

/*Insertamos la información en la tabla VEHICULO*/
INSERT INTO VEHICULO VALUES('2215LKJ','Renault','Clio','2021',56000, 'Revision Correcta 01-03-2023', 'A', '000001' );
INSERT INTO VEHICULO VALUES('3114MHI','Peugeot','3008','2022',75600, NULL, 'A', '000001' );
INSERT INTO VEHICULO VALUES('8885MMD','Mercedes','GLC350','2023',1500, 'Revision Correcta 01-03-2023', 'A', '000003' );
INSERT INTO VEHICULO VALUES('4125JFC','Renault','Captur','2017',30000, 'Revision Correcta 01-03-2023', 'B', '000003' );
INSERT INTO VEHICULO VALUES('6598HGF','Nissan','Qasqhai','2019',89100, NULL, 'B','000002' );
INSERT INTO VEHICULO VALUES('1147FKN','Nissan','Micra','2019',155600, 'Revision Correcta 01-01-2023', 'A', '000001' );
INSERT INTO VEHICULO VALUES('5442HHN','Opel','Mokka','2019',45200, NULL, 'B', '000002' );
INSERT INTO VEHICULO VALUES('6541JHF','Volkswagen','Golf VII','2020',65000, NULL, 'A','000004' );
INSERT INTO VEHICULO VALUES('5421KKJ','Volkswagen','Polo','2020',45600, 'En taller', 'B', '000004' );
INSERT INTO VEHICULO VALUES('6565FRS','BMW','X1','2018',190500, NULL, 'A', '000003' );
INSERT INTO VEHICULO VALUES('9851KGF','BMW','330','2020',85100, NULL, 'B', '000001' );
INSERT INTO VEHICULO VALUES('1249DDK','Mercedes','A160','2018',225600, 'Revision proxima', 'A', '000002' );
INSERT INTO VEHICULO VALUES('9877EGR','Peugeot','307','2009',285600, 'Puerta copiloto arañada', 'A', '000002' );
INSERT INTO VEHICULO VALUES('5421DEK','Renault','Twingo','2008',275200, 'Tapiceria Deteriorada', 'A', '000003' );
INSERT INTO VEHICULO VALUES('4848DRB','Nissan','Almera','2011',215600, 'Revision Correcta 01-01-2023', 'A', '000004' );
INSERT INTO VEHICULO VALUES('3232DCV','Ford','Fiesta','2007',355000, 'SIN ITV', 'C', '000001' );

/*Insertamos la información en la tabla ALQUILAR*/
INSERT INTO ALQUILAR VALUES('6598HGF','55555555E','2021-12-14','2022-01-08',846,NULL, 700 );
INSERT INTO ALQUILAR VALUES('4848DRB','55555555E','2016-04-05','2016-04-10',420,NULL, 225 );
INSERT INTO ALQUILAR VALUES('4848DRB','25252525J','2016-04-01','2016-04-04',210,NULL, 180 );
INSERT INTO ALQUILAR VALUES('4848DRB','85858585H','2016-04-10','2016-04-11',130,'Arañazo en faldon trasero', 75 );
INSERT INTO ALQUILAR VALUES('4848DRB','11111111A','2016-04-13','2016-04-19',500,NULL, 350 );
INSERT INTO ALQUILAR VALUES('4848DRB','96969696I','2016-04-20','2016-04-22',300,NULL, 200 );
INSERT INTO ALQUILAR VALUES('4848DRB','11111111A','2016-04-27','2016-04-30',240,NULL, 270 );
INSERT INTO ALQUILAR VALUES('6541JHF','55555555E','2015-01-14','2015-01-18',380,NULL, 350 );
INSERT INTO ALQUILAR VALUES('6541JHF','55555555E','2015-03-12','2015-03-19',600,'Multa de aparcamiento, reclamar 100$', 750 );
INSERT INTO ALQUILAR VALUES('6541JHF','55555555E','2015-04-23','2015-04-25',140,NULL, 225 );
INSERT INTO ALQUILAR VALUES('6541JHF','55555555E','2015-06-18','2015-06-23',300,'Cliente indica que pincho rueda delantera izquierda', 400 );
INSERT INTO ALQUILAR VALUES('6541JHF','55555555E','2015-10-01','2015-10-07',430,NULL, 650);
INSERT INTO ALQUILAR VALUES('6541JHF','55555555E','2015-12-11','2015-12-12',90,'Deposito sin llenar', 70 );
INSERT INTO ALQUILAR VALUES('6598HGF','74747474G','2019-12-14','2020-01-16',1200,'Multa exceso velocidad, reclamar 200$', 1750 );
INSERT INTO ALQUILAR VALUES('4848DRB','33333333C','2023-01-19','2023-01-22',290,NULL, 400 );
INSERT INTO ALQUILAR VALUES('1249DDK','55555555E','2019-07-05','2019-07-08',180,NULL, 150 );